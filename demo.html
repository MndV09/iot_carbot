<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Secuencias Autom치ticas - IoT Car</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="icon" type="image/png" href="imagenes/carreras.png">
</head>
<body class="bg-dark text-white">

  <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary shadow-lg">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="index.html">
        <i class="bi bi-arrow-left me-2"></i>
        <img src="imagenes/carreras.png" alt="IoT Car" width="30" height="30" class="me-2">
        <span class="d-none d-sm-inline">IoT Car</span>
      </a>
      <span class="navbar-text fw-bold d-none d-lg-block">Secuencias Autom치ticas</span>
      
      <div class="navbar-nav ms-auto">
        <a class="nav-link fw-bold mx-2" href="control.html"><i class="bi bi-joystick me-1"></i>Control</a>
        <a class="nav-link active fw-bold mx-2" href="demo.html"><i class="bi bi-play-circle me-1"></i>Secuencias</a>
        <a class="nav-link fw-bold mx-2" href="monitor.html"><i class="bi bi-graph-up me-1"></i>Monitor</a>
      </div>
    </div>
  </nav>

  <main class="container py-3 d-flex flex-column justify-content-center h-100">
    
    <div class="row g-3 w-100" style="flex: 1; max-height: 850px;">
      
      <div class="col-lg-5 h-100 d-flex flex-column">
        <div class="card glass-card border-0 shadow-lg h-100">
          <div class="card-body d-flex flex-column p-3">
            
            <h4 class="fw-bold mb-3 gradient-text flex-shrink-0">
              <i class="bi bi-puzzle me-2"></i>Constructor de Pasos
            </h4>

            <div class="row g-2 align-items-end mb-3 flex-shrink-0">
              <div class="col-7">
                <label class="form-label text-white small mb-1">Movimiento</label>
                <select id="selMove" class="form-select form-select-sm">
                  <option disabled selected value="">Seleccione...</option>
                </select>
              </div>
              <div class="col-5">
                <label class="form-label text-white small mb-1">Duraci칩n (ms)</label>
                <input id="inpDuration" type="number" class="form-control form-control-sm" min="100" step="100" placeholder="800" />
              </div>
            </div>

            <div class="d-flex gap-2 mb-3 flex-shrink-0">
              <button id="btnAddStep" class="btn btn-success btn-sm fw-bold flex-fill">
                <i class="bi bi-plus-circle me-1"></i>Agregar
              </button>
              <button id="btnLoadExample" class="btn btn-outline-light btn-sm flex-fill">
                <i class="bi bi-cloud-download me-1"></i>Ejemplo
              </button>
              <button id="btnClearSteps" class="btn btn-outline-danger btn-sm flex-fill">
                <i class="bi bi-trash me-1"></i>Limpiar
              </button>
            </div>

            <div class="table-responsive flex-grow-1 border rounded border-secondary bg-black bg-opacity-25" style="overflow-y: auto;">
              <table class="table table-dark table-striped table-sm align-middle mb-0">
                <thead style="position: sticky; top: 0; z-index: 10;">
                  <tr>
                    <th style="width:40px;">#</th>
                    <th>Movimiento</th>
                    <th style="width:90px">Duraci칩n</th>
                    <th style="width:50px"></th>
                  </tr>
                </thead>
                <tbody id="tblSteps">
                  </tbody>
              </table>
            </div>

          </div>
        </div>
      </div>

      <div class="col-lg-7 h-100 d-flex flex-column">
        <div class="row h-100 g-3">
          
          <div class="col-md-6 h-100 d-flex flex-column">
            <div class="card glass-card border-0 shadow-lg h-100">
              <div class="card-body d-flex flex-column p-3">
                <h4 class="fw-bold mb-3 gradient-text flex-shrink-0">
                  <i class="bi bi-plus-square me-2"></i>Nueva Secuencia
                </h4>
                
                <div class="mb-2">
                  <label class="form-label text-white small mb-1">Nombre</label>
                  <input id="inpDemoName" type="text" class="form-control form-control-sm" placeholder="DEMO_X" />
                </div>
                
                <div class="mb-2">
                  <label class="form-label text-white small mb-1">Owner ID</label>
                  <input id="inpOwnerDevice" type="number" class="form-control form-control-sm" min="1" value="1" />
                </div>
                
                <div class="mb-2 flex-grow-1 d-flex flex-column">
                  <label class="form-label text-white small mb-1">JSON Generado</label>
                  <textarea id="taStepsJson" class="form-control form-control-sm flex-grow-1" style="resize: none;" readonly placeholder="[ ... ]"></textarea>
                </div>
                
                <div class="mt-auto pt-2">
                  <button id="btnCreateDemo" class="btn btn-success btn-sm fw-bold w-100 py-2">
                    <i class="bi bi-check-lg me-1"></i>Crear DEMO
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6 h-100 d-flex flex-column">
            <div class="card glass-card border-0 shadow-lg h-100">
              <div class="card-body d-flex flex-column p-3">
                <h4 class="fw-bold mb-3 gradient-text flex-shrink-0">
                  <i class="bi bi-rocket me-2"></i>Ejecutar
                </h4>

                <div class="d-flex gap-2 mb-2 align-items-center">
                  <button id="btnRefreshDemos" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-arrow-clockwise"></i>
                  </button>
                  <select id="selDemo" class="form-select form-select-sm flex-grow-1">
                    <option disabled selected value="">Seleccione DEMO...</option>
                  </select>
                </div>

                <div class="row g-2 mb-3">
                  <div class="col-6">
                    <label class="small text-white-50">Device ID</label>
                    <input id="inpRunDevice" type="number" class="form-control form-control-sm" value="1" />
                  </div>
                  <div class="col-6">
                    <label class="small text-white-50">Delay (ms)</label>
                    <input id="inpRunDelay" type="number" class="form-control form-control-sm" value="0" />
                  </div>
                </div>

                <button id="btnRunDemo" class="btn btn-primary btn-sm fw-bold w-100 mb-3 py-2">
                  <i class="bi bi-play-fill me-1"></i>EJECUTAR AHORA
                </button>

                <div class="d-flex flex-column flex-grow-1 min-h-0">
                  <h5 class="fw-bold mb-1 gradient-text small">
                    <i class="bi bi-terminal me-2"></i>Log de Eventos
                  </h5>
                  <div id="demoLog" class="log-container flex-grow-1" style="overflow-y: auto;">
                    </div>
                </div>

              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </main>

 <footer class="bg-dark border-top border-secondary py-2">
    <div class="container">
      <div class="text-center">
        <p class="mb-0 small text-white-50">
          <i class="bi bi-cpu me-1"></i>Desarrollado por: 
          <span class="text-info">Amanda Cabrales Vega</span>
        </p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script type="module">
    import { demo } from "./js/api.js";
    async function refreshDemos() {
      try {
          const owner = document.getElementById('inpOwnerDevice')?.value || 1;
      } catch(e) {}
    }
    document.addEventListener("DOMContentLoaded", refreshDemos);
  </script>
  <script type="module" src="./js/demo.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>